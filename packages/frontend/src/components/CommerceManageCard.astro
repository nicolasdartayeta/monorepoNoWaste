---
import { app } from '@/lib/apiTreaty';

const commerces = await app.commerce.all.get()

---

<div class="div">
    <table class="min-w-full bg-white border border-gray-200 shadow-md rounded-md">
        <tr>
            <th>ID</th>
            <th>Name</th>
            <th>Description</th>
            <th>Address</th>
            <th>City</th>
            <th>Creacion</th>
            <th>Activo?</th>
            <th>Owner Id</th>
        </tr>
        {commerces.data && commerces.data.length > 0
        ?
            commerces.data?.map((commerce) => (
                <tr class="border-b border-gray-200 hover:bg-gray-100">
                <td class="py-3 px-6 text-center border border-gray-100">{commerce.id}</td>
                <td class="py-3 px-6 text-center border border-gray-100">{commerce.name}</td>
                <td class="py-3 px-6 text-center border border-gray-100">{commerce.description}</td>
                <td class="py-3 px-6 text-center border border-gray-100">{commerce.address}</td>
                <td class="py-3 px-6 text-center border border-gray-100">{commerce.city}</td>
                <td class="py-3 px-6 text-center border border-gray-100">{commerce.creation_date.toString()}</td>
                <td class="py-3 px-6 text-center border border-gray-100">{commerce.active}</td>
                <td class="py-3 px-6 text-center border border-gray-100">{commerce.owner_id}</td>
                <td class="py-3 px-6 text-center border border-gray-100"> 
                    <a href={`/admin/manageCommerce?id=${commerce.id}&name=${encodeURIComponent(commerce.name)}&description=${encodeURIComponent(commerce.description)}&address=${encodeURIComponent(commerce.address)}&city=${encodeURIComponent(commerce.city)}&creation_date=${encodeURIComponent( new Date(commerce.creation_date).toISOString().split('T')[0])}&active=${encodeURIComponent(commerce.active ? 'true' : 'false')}&owner_id=${encodeURIComponent(commerce.owner_id)}`}>
                        <button 
                            id="addUser" 
                            class="bg-blue-500 text-white py-2 px-4 rounded hover:bg-blue-600 focus:outline-none">
                            Editar Comercio
                        </button>  
                    </a>
                </td>
                </tr>))
        :  <td>No hay comercios en la base de datos</td>
        }
        
    </table>
    <a href={`/admin/manageCommerce`}> 
        <button 
            id="addUser" 
            class="bg-slate-500 py-2 px-3 text-white font-bold rounded-lg">
            Agregar Comercio
        </button>  
    </a>
       
</div>
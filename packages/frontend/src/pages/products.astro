---
import ProductCard from '@/components/ProductCard.astro';
import Layout from '@/layouts/Layout.astro';
import {api} from '@/lib/api';
import type { Product } from '@server/db/schema';
// interface Product {
//   id: string; 
//   name: string;
//   description: string;
//   price: string;
//   expiration_date: Date;
//   collection_id: string; 
// }

const API_URL = new URL("http://localhost:3000/product");
const productos: Product[] | undefined = await api.get(API_URL.toString());
console.log(productos);
---

<Layout title="NoWaste">
    <div class = "grid grid-cols-1 gap-2 p-4">
        {
        productos && productos.length > 0
        ? productos.map((producto) => (
            <ProductCard
                id={producto.id}
                name={producto.name} 
                description={producto.description}
                price={producto.price}
                expiration_date={producto.expiration_date}/>
        ))
        : <p>No hay productos en la base de datos</p>
        }
    </div>  
</Layout>